<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magical Shop - BookLover</title>
    <!-- Use main style first for variables and base -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/shop.css">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css">
    <!-- Ionicons -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</head>

<body>

    <!-- Header will be loaded here -->
    <div id="header"></div>

    <!-- Shop Hero -->
    <section class="shop-hero" data-aos="fade-up">
        <div class="hero-floats">
            <ion-icon name="book-outline" class="float-item"
                style="top: 20%; left: 10%; color: #FF6B6B; --delay: 3s;"></ion-icon>
            <ion-icon name="star-outline" class="float-item"
                style="bottom: 30%; right: 15%; color: #FFD93D; --delay: 2s;"></ion-icon>
            <ion-icon name="glasses-outline" class="float-item"
                style="top: 15%; right: 20%; color: #4D96FF; --delay: 4s;"></ion-icon>
            <ion-icon name="flask-outline" class="float-item"
                style="bottom: 20%; left: 15%; color: #6BCB77; --delay: 2.5s;"></ion-icon>
        </div>

        <div class="container hero-layout"
            style="position: relative; z-index: 2; display: flex; align-items: center; justify-content: space-between; gap: 50px;">
            <div class="hero-content" style="flex: 1; text-align: left;" data-aos="fade-right">
                <span class="pill-badge glass-pill">
                    <ion-icon name="sparkles" style="color: #FFD93D; margin-right: 5px;"></ion-icon>
                    Premium Collection
                </span>
                <h1 class="hero-title">Discover Your <br> <span class="gradient-text">Next Adventure</span></h1>
                <p class="hero-subtitle">Explore our curated collection of bestsellers, classics, and hidden gems
                    waiting to be read.</p>

                <!-- Search -->
                <div class="search-container" style="margin: 0;">
                    <input type="text" class="search-input" placeholder="Search for title, author, or genre...">
                    <button class="search-btn">
                        <ion-icon name="search-outline"></ion-icon>
                    </button>
                </div>

                <div class="hero-tags">
                    <span>Fiction</span>
                    <span>Sci-Fi</span>
                    <span>History</span>
                </div>
            </div>

            <div class="hero-visual" style="flex: 1; display: flex; justify-content: center; perspective: 1500px;"
                data-aos="fade-left" data-aos-delay="150">
                <div class="hero-book-wrapper">
                    <div class="hero-book-3d">
                        <div class="face front">
                            <img src="https://images.unsplash.com/photo-1534447677768-be436bb09401?auto=format&fit=crop&q=80&w=600"
                                alt="Featured Book">
                        </div>
                        <div class="face back"></div>
                        <div class="face left"></div>
                        <div class="face right"></div>
                        <div class="face top"></div>
                        <div class="face bottom"></div>
                    </div>
                    <div class="book-shadow"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Filters -->
    <div class="container">
        <div class="category-filter" data-aos="fade-up">
            <div class="filter-pill active" data-category="all" data-aos="zoom-in" data-aos-delay="50">All Books</div>
            <div class="filter-pill" data-category="fiction" data-aos="zoom-in" data-aos-delay="100">Fiction</div>
            <div class="filter-pill" data-category="self-growth" data-aos="zoom-in" data-aos-delay="150">Self-Growth
            </div>
            <div class="filter-pill" data-category="science" data-aos="zoom-in" data-aos-delay="200">Science</div>
            <div class="filter-pill" data-category="fantasy" data-aos="zoom-in" data-aos-delay="250">Fantasy</div>
            <div class="filter-pill" data-category="history" data-aos="zoom-in" data-aos-delay="300">History</div>
        </div>

        <!-- Featured / Trending -->
        <h2 class="category-section-title" data-aos="fade-up"><ion-icon name="flame"
                style="color: #FF6B6B;"></ion-icon> Trending Now</h2>

        <div class="shop-grid">
            <!-- FICTION -->


            <div class="book-card" data-category="fiction" data-aos="fade-up" data-aos-delay="50">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&q=80&w=600"
                        alt="Lessons in Chemistry" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">Lessons in Chemistry</h3>
                    <p class="book-author">Bonnie Garmus</p>
                    <div class="book-footer">
                        <div class="book-price">$18.99</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <!-- SELF GROWTH -->
            <div class="book-card" data-category="self-growth" data-aos="fade-up" data-aos-delay="100">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1456324504439-367cee3b3c32?auto=format&fit=crop&q=80&w=600"
                        alt="The Art of Impossible" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">The Art of Impossible</h3>
                    <p class="book-author">Steven Kotler</p>
                    <div class="book-footer">
                        <div class="book-price">$24.99</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <div class="book-card" data-category="self-growth" data-aos="fade-up" data-aos-delay="150">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1506784983877-45594efa4cbe?auto=format&fit=crop&q=80&w=600"
                        alt="Atomic Habits" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">Atomic Habits</h3>
                    <p class="book-author">James Clear</p>
                    <div class="book-footer">
                        <div class="book-price">$19.95</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <div class="book-card" data-category="self-growth" data-aos="fade-up" data-aos-delay="200">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?auto=format&fit=crop&q=80&w=600"
                        alt="The Mountain Is You" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">The Mountain Is You</h3>
                    <p class="book-author">Brianna Wiest</p>
                    <div class="book-footer">
                        <div class="book-price">$16.00</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <!-- FANTASY -->
            <div class="book-card" data-category="fantasy" data-aos="fade-up" data-aos-delay="250">
                <div class="badge-new">Trending</div>
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1577493340887-b7bfff550145?auto=format&fit=crop&q=80&w=600"
                        alt="Fourth Wing" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">Fourth Wing</h3>
                    <p class="book-author">Rebecca Yarros</p>
                    <div class="book-footer">
                        <div class="book-price">$18.99</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>



            <div class="book-card" data-category="fantasy" data-aos="fade-up" data-aos-delay="300">
                <div class="badge-new">New Release</div>
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1534447677768-be436bb09401?auto=format&fit=crop&q=80&w=600"
                        alt="Wind and Truth" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">Wind and Truth</h3>
                    <p class="book-author">Brandon Sanderson</p>
                    <div class="book-footer">
                        <div class="book-price">$29.99</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <!-- SCIENCE -->
            <div class="book-card" data-category="science" data-aos="fade-up" data-aos-delay="350">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1530026405186-ed1f139313f8?auto=format&fit=crop&q=80&w=600"
                        alt="Why We Die" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">Why We Die</h3>
                    <p class="book-author">Venki Ramakrishnan</p>
                    <div class="book-footer">
                        <div class="book-price">$22.00</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <div class="book-card" data-category="science" data-aos="fade-up" data-aos-delay="400">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1550684848-fac1c5b4e853?auto=format&fit=crop&q=80&w=600"
                        alt="Sapiens" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">Sapiens</h3>
                    <p class="book-author">Yuval Noah Harari</p>
                    <div class="book-footer">
                        <div class="book-price">$21.00</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>

            <!-- HISTORY -->
            <div class="book-card" data-category="history" data-aos="fade-up" data-aos-delay="450">
                <div class="book-cover">
                    <img src="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&q=80&w=600"
                        alt="The Wager" class="book-image">
                </div>
                <div class="book-details">
                    <h3 class="book-title">The Wager</h3>
                    <p class="book-author">David Grann</p>
                    <div class="book-footer">
                        <div class="book-price">$19.99</div>
                        <div class="add-btn"><ion-icon name="bag-add-outline"></ion-icon></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer will be loaded here -->
    <div id="footer"></div>

    <!-- Main Interactions Script -->
    <script src="../js/script.js"></script>
    <script src="../js/cart.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

    <!-- Header/Footer Loading Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            AOS.init({
                duration: 800,
                once: true,
                offset: 80
            });
        });

        // Initialize Header and Footer
        fetch('../component/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header').innerHTML = data;
                updateCartBadge();
            });

        fetch('../component/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });

        // --- Category Filter Logic ---
        const filterPills = document.querySelectorAll('.filter-pill');
        const bookCards = document.querySelectorAll('.book-card');
        const sectionTitles = document.querySelectorAll('.category-section-title');
        const searchInput = document.querySelector('.search-input');
        const searchBtn = document.querySelector('.search-btn');

        // Function to filter books based on category and search term
        function filterContent(category, searchTerm = '') {
            searchTerm = searchTerm.toLowerCase().trim();

            // Toggle Section Titles based on mode
            if (category === 'all' && searchTerm === '') {
                sectionTitles.forEach(title => title.style.display = 'flex');
            } else {
                sectionTitles.forEach(title => title.style.display = 'none');
            }

            bookCards.forEach(card => {
                const cardCategory = card.getAttribute('data-category');
                const title = card.querySelector('.book-title').innerText.toLowerCase();
                const author = card.querySelector('.book-author').innerText.toLowerCase();

                const matchesCategory = (category === 'all' || category === cardCategory);
                const matchesSearch = (title.includes(searchTerm) || author.includes(searchTerm));

                if (matchesCategory && matchesSearch) {
                    card.style.display = 'flex';
                    card.style.animation = 'none';
                    card.offsetHeight; /* trigger reflow */
                    card.style.animation = 'cardEntrance 0.5s ease forwards';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Category Click Event
        filterPills.forEach(pill => {
            pill.addEventListener('click', () => {
                filterPills.forEach(p => p.classList.remove('active'));
                pill.classList.add('active');

                const category = pill.getAttribute('data-category');
                const relativeSearch = searchInput.value; // Keep current search if any
                filterContent(category, relativeSearch);
            });
        });

        // Search Input Event
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value;
            const activePill = document.querySelector('.filter-pill.active');
            const currentCategory = activePill ? activePill.getAttribute('data-category') : 'all';

            filterContent(currentCategory, searchTerm);
        });

        // Search Button Click
        searchBtn.addEventListener('click', () => {
            const searchTerm = searchInput.value;
            const activePill = document.querySelector('.filter-pill.active');
            const currentCategory = activePill ? activePill.getAttribute('data-category') : 'all';

            filterContent(currentCategory, searchTerm);
        });

        // --- Click Handler for Detail Page ---
        // Ensure elements exist before adding listeners to avoid errors
        const cards = document.querySelectorAll('.book-card');
        if (cards.length > 0) {
            // Add click event to book cards for navigation
            cards.forEach(card => {
                card.style.cursor = 'pointer';

                // Find the add button inside this card and stop propagation on it specifically
                const addBtn = card.querySelector('.add-btn');
                if (addBtn) {
                    addBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        // The existing onclick logic on the button (if any) will still fire
                    });
                }

                card.addEventListener('click', (e) => {
                    // Double check just in case
                    if (e.target.closest('.add-btn')) return;

                    const title = card.querySelector('.book-title').innerText;
                    const author = card.querySelector('.book-author').innerText;
                    const price = card.querySelector('.book-price').innerText;
                    const image = card.querySelector('img').src;

                    // URL Encode params
                    const params = new URLSearchParams({
                        title: title,
                        author: author,
                        price: price,
                        image: image
                    });

                    window.location.href = `shop-detail.html?${params.toString()}`;
                });
            });
        }
    </script>
</body>

</html>
